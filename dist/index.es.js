var e={size:["height","width"],clientSize:["clientHeight","clientWidth"],offsetSize:["offsetHeight","offsetWidth"],maxSize:["maxHeight","maxWidth"],before:["top","left"],marginBefore:["marginTop","marginLeft"],after:["bottom","right"],marginAfter:["marginBottom","marginRight"],scrollOffset:["pageYOffset","pageXOffset"]};function t(e){return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}}export default function(o,r,f,a,i){void 0===f&&(f="bottom"),void 0===a&&(a="center"),void 0===i&&(i={}),(r instanceof Element||r instanceof Range)&&(r=t(r.getBoundingClientRect()));var n=Object.assign({top:r.bottom,bottom:r.top,left:r.right,right:r.left},r),s={top:0,left:0,bottom:window.innerHeight,right:window.innerWidth};i.bound&&((i.bound instanceof Element||i.bound instanceof Range)&&(i.bound=t(i.bound.getBoundingClientRect())),Object.assign(s,i.bound));var l=getComputedStyle(o),b={},m={};for(var g in e)b[g]=e[g]["top"===f||"bottom"===f?0:1],m[g]=e[g]["top"===f||"bottom"===f?1:0];o.style.position="absolute",o.style.maxWidth="",o.style.maxHeight="";var d=parseInt(l[m.marginBefore]),p=parseInt(l[m.marginAfter]),u=d+p,c=s[m.after]-s[m.before]-u,h=parseInt(l[m.maxSize]);(!h||c<h)&&(o.style[m.maxSize]=c+"px");var x=parseInt(l[b.marginBefore])+parseInt(l[b.marginAfter]),y=n[b.before]-s[b.before]-x,z=s[b.after]-n[b.after]-x;(f===b.before&&o[b.offsetSize]>y||f===b.after&&o[b.offsetSize]>z)&&(f=y>z?b.before:b.after);var S=f===b.before?y:z,v=parseInt(l[b.maxSize]);(!v||S<v)&&(o.style[b.maxSize]=S+"px");var w=window[b.scrollOffset],O=function(e){return Math.max(s[b.before],Math.min(e,s[b.after]-o[b.offsetSize]-x))};f===b.before?(o.style[b.before]=w+O(n[b.before]-o[b.offsetSize]-x)+"px",o.style[b.after]="auto"):(o.style[b.before]=w+O(n[b.after])+"px",o.style[b.after]="auto");var B=window[m.scrollOffset],I=function(e){return Math.max(s[m.before],Math.min(e,s[m.after]-o[m.offsetSize]-u))};switch(a){case"start":o.style[m.before]=B+I(n[m.before]-d)+"px",o.style[m.after]="auto";break;case"end":o.style[m.before]="auto",o.style[m.after]=B+I(document.documentElement[m.clientSize]-n[m.after]-p)+"px";break;default:var H=n[m.after]-n[m.before];o.style[m.before]=B+I(n[m.before]+H/2-o[m.offsetSize]/2-d)+"px",o.style[m.after]="auto"}o.dataset.side=f,o.dataset.align=a}
